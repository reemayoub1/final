"0","pca <- crimeVhomic%>%select_if(is.numeric)%>%scale"
"0","ch_pca <- princomp(pca)"
"0","summary(ch_pca, loadings=T)"
"1","Importance of components:
"
"1","                      "
"1","    Comp.1"
"1","    Comp.2"
"1","    Comp.3"
"1","    Comp.4"
"1","     Comp.5"
"1","     Comp.6"
"1","
Standard deviation    "
"1"," 1.8950829"
"1"," 1.3736148"
"1"," 1.2588360"
"1"," 1.1353830"
"1"," 1.01347582"
"1"," 0.84518783"
"1","
Proportion of Variance"
"1"," 0.2997089"
"1"," 0.1574610"
"1"," 0.1322457"
"1"," 0.1075791"
"1"," 0.08571759"
"1"," 0.05961419"
"1","
Cumulative Proportion "
"1"," 0.2997089"
"1"," 0.4571699"
"1"," 0.5894156"
"1"," 0.6969947"
"1"," 0.78271230"
"1"," 0.84232649"
"1","
"
"1","                      "
"1","     Comp.7"
"1","     Comp.8"
"1","     Comp.9"
"1","    Comp.10"
"1","    Comp.11"
"1","     Comp.12"
"1","
Standard deviation    "
"1"," 0.76837520"
"1"," 0.72960139"
"1"," 0.59760861"
"1"," 0.42948400"
"1"," 0.39657507"
"1"," 0.260347008"
"1","
Proportion of Variance"
"1"," 0.04927083"
"1"," 0.04442368"
"1"," 0.02980416"
"1"," 0.01539349"
"1"," 0.01312484"
"1"," 0.005656508"
"1","
Cumulative Proportion "
"1"," 0.89159732"
"1"," 0.93602100"
"1"," 0.96582516"
"1"," 0.98121865"
"1"," 0.99434349"
"1"," 1.000000000"
"1","
"
"1","
Loadings:
"
"1","             "
"1"," Comp.1"
"1"," Comp.2"
"1"," Comp.3"
"1"," Comp.4"
"1"," Comp.5"
"1"," Comp.6"
"1"," Comp.7"
"1"," Comp.8"
"1"," Comp.9"
"1"," Comp.10"
"1"," Comp.11"
"1","
ID           "
"1","       "
"1","       "
"1","  0.179"
"1","       "
"1","  0.913"
"1","  0.208"
"1","       "
"1","  0.277"
"1","       "
"1","        "
"1","        "
"1","
Assault      "
"1","  0.481"
"1","       "
"1","       "
"1"," -0.286"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","        "
"1","        "
"1","
AutoTheft    "
"1","  0.299"
"1","  0.134"
"1","       "
"1","  0.476"
"1","  0.153"
"1"," -0.157"
"1","  0.490"
"1"," -0.522"
"1","  0.112"
"1","  0.156 "
"1"," -0.254 "
"1","
BreakandEnter"
"1","  0.454"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1"," -0.313"
"1","  0.330"
"1"," -0.245"
"1","  0.357 "
"1"," -0.525 "
"1","
Robbery      "
"1","  0.451"
"1","       "
"1","       "
"1"," -0.155"
"1","       "
"1","       "
"1","       "
"1","       "
"1","  0.749"
"1"," -0.218 "
"1","  0.153 "
"1","
TheftOver    "
"1","  0.457"
"1","  0.108"
"1","       "
"1","  0.168"
"1","       "
"1","       "
"1","       "
"1","       "
"1"," -0.542"
"1"," -0.371 "
"1","  0.529 "
"1","
Homicide     "
"1","       "
"1","  0.568"
"1"," -0.374"
"1"," -0.226"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","  0.569 "
"1","  0.389 "
"1","
Other        "
"1","       "
"1","  0.372"
"1","  0.440"
"1","       "
"1","       "
"1","  0.542"
"1"," -0.385"
"1"," -0.454"
"1","       "
"1","        "
"1","        "
"1","
Shooting     "
"1","       "
"1","  0.362"
"1","  0.419"
"1","  0.132"
"1"," -0.327"
"1","  0.141"
"1","  0.550"
"1","  0.490"
"1","       "
"1","        "
"1","        "
"1","
Stabbing     "
"1","       "
"1","  0.292"
"1","  0.468"
"1","       "
"1","       "
"1"," -0.781"
"1"," -0.270"
"1","       "
"1","       "
"1","        "
"1","        "
"1","
perc_hom     "
"1"," -0.181"
"1","  0.505"
"1"," -0.408"
"1"," -0.172"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1"," -0.571 "
"1"," -0.420 "
"1","
perc_assu    "
"1","  0.121"
"1"," -0.116"
"1","  0.234"
"1"," -0.725"
"1","       "
"1","       "
"1","  0.360"
"1"," -0.286"
"1"," -0.254"
"1","        "
"1"," -0.138 "
"1","
"
"1","             "
"1"," Comp.12"
"1","
ID           "
"1","        "
"1","
Assault      "
"1"," -0.816 "
"1","
AutoTheft    "
"1","        "
"1","
BreakandEnter"
"1","  0.298 "
"1","
Robbery      "
"1","  0.355 "
"1","
TheftOver    "
"1","  0.173 "
"1","
Homicide     "
"1","        "
"1","
Other        "
"1","        "
"1","
Shooting     "
"1","        "
"1","
Stabbing     "
"1","        "
"1","
perc_hom     "
"1","        "
"1","
perc_assu    "
"1","  0.295 "
"1","
"
"0","eigval<-ch_pca$sdev^2"
"0","varprop=round(eigval/sum(eigval),2)"
"0",""
"0","ggplot()+geom_bar(aes(y=varprop,x=1:12),stat=""identity"")+xlab("""")+geom_path(aes(y=varprop,x=1:12))+"
"0"," geom_text(aes(x=1:12,y=varprop,label=round(varprop,2)),vjust=1,col=""white"",size=5)+"
"0"," scale_y_continuous(breaks=seq(0,.6,.2),labels = scales::percent)+"
"0"," scale_x_continuous(breaks=1:10)"
